<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">

<html>
<head>
<title>AT&amp;T Labs Research - Grappa - Change History</title>
<meta name="description" content="AT&&T Labs Research Grappa Change History Page">
<meta name="keywords" content="Grappa, Java Graph Drawing Package">
<link rev="made" href="mailto:webmaster@research.att.com"> 
</head>

<!-- user content -->


<H1 ALIGN="CENTER">Grappa<BR>
Change History</H1>

<H2>September 22, 2010</H2>
<UL>
<LI>
Substantial performance improvements courtesy of Charles Ballance.
</UL>

<H2>March  4, 2008</H2>
<UL>
<LI>
Minor change to default style handling in GrappaStyle.java
</UL>

<H2>October 10, 2006</H2>
<UL>
<LI>
Fixed reported bugs <a target=_bugwindow href='http://www.graphviz.org/bugs/b440.html'>440</a> and
<a target=_bugwindow href='http://www.graphviz.org/bugs/b1031.html'>1031</a> relating to
infinte paint looping in GrappaPanel.
</UL>

<H2>April 27, 2006</H2>
<UL>
<LI>
Fixed bug with addTag in Element.java
</UL>

<H2>March  4, 2006</H2>
<UL>
<LI>
Made 'filterMode' variable public in the Graph class.
It is a flag that indicates that the edge name should be included in the
edge attributes when output is generated by printGraph.
</UL>

<H2>January 12, 2006</H2>
<UL>
<LI>
Moved call to java.awt.Toolkit.getDefaultToolkit() from Grappa.java to
GrappaNexus.java so that it is not actually called until it is
really needed.
</UL>

<H2>August 21, 2005</H2>
<UL>
<LI>
Added fix into Element.java suggested by Martin Bierkoch and also made changes
to Lexer.java that allows Grappa to pass through labels that begin with
<b>&#60;</b> and end with <b>&#62;</b>.
Such labels are used by the graphviz tools to provide HTML-like formatting of
labels. Grappa itself does not decipher them. The fix simply keeps
Grappa from corrupting them.
</UL>

<H2>May 26, 2005</H2>
<UL>
<LI>
Distribution now includes the proper license files (Grappa is licensed under
Common Public License as put out by the Open Source Foundation).
<LI>
Included a new demo file (StickBuilt.java) that shows how to build a graph
up directly within a Java program (it places the nodes in a simple-minded
manner, but provides a button to invoke the "dot" layout engine over the web).
</UL>

<H2>May 25, 2005</H2>
<UL>
<LI>
Grappa will now compile under JDK1.5, though there will be the following
warnings:
<BLOCKQUOTE>
<PRE>
Note: Some input files use unchecked or unsafe operations.
Note: Recompile with -Xlint:unchecked for details.
</PRE>
</BLOCKQUOTE>
since the new <i>Generics</i> capabilities in JDK1.5 were not employed.
It seems to me that the warnings can be safely ignored.
</UL>

<H2>December 1, 2004</H2>
<UL>
<LI>
Grappa will now recognize <i>headlabel</i>, <i>head_lp</i>, <i>taillabel</i>
and <i>tail_lp</i> as edge attributes.
Both the label and position attribute must be present for the label to
appear (i.e., Grappa will not even guess at a label position if it is
not present).
</UL>

<H2>November 18, 2004</H2>
<UL>
<LI>
Grappa will now recognize <i>point</i> as a node shape attribute.
</UL>

<H2>October 8, 2004</H2>
<UL>
<LI>
Fixed bug in addGrappaListener that failed to remove
old mouse activity listeners when addGrappaListener is used more than once.
Thanks to Christope Dousson for finding and correcting the problem.
</UL>

<H2>August 12, 2004</H2>
<UL>
<LI>
Added call to EventQueue.invokeLater in GrappaPanel.java to position
graph at center of a
swept zoom box (needed to make sure scaling changes are completed
before positioning is calculated)
<LI>
Added centerPanelAtPoint method in GrappaPanel
<LI>
Made the setName(String) method in Node public to allow the node name
to be changed after the node has been created
</UL>

<H2>February 7, 2003</H2>
<UL>
<LI>
Modified some string handling so that non-ASCII alphabetic characters
could be used in node names without the need for double quotes.
</UL>

<H2>June 13, 2002</H2>
<UL>
<LI>
Relaxed some GrappaAdapter field permissions so that classes that extend it can really access all they need to access to at least duplicate what is
performed in GrappaAdapter itself (and hopefully more).
<LI>
Added additional options when the rightmost mouse button is clicked within a
GrappaPanel when GrappaAdapter is being used.
</UL>

<H2>May 13, 2002</H2>
<UL>
<LI>
Now when clicking mouse button 1 to select a single element, the selction cycles through all possible choices with each subsequent click.
For example, if there is a node within a subgraph within the main graph, then the first click in the node selects the node, the second selects the subgraph and third selects the main graph. The next click would once again select the node.
<LI>
Added global variables in the <i>Grappa</i> class to make types of elements
(subgraphs, nodes or edges) unselectable, if desired.
<LI>
Finally made edge selection work better by creating a fat, invisible version of the edge shape for selection purposes. The problem here was that Java's
<i>contains</i> and <i>intersects</i> methods do not work with straight
lines since a straight line has no interior.
</UL>

<H2>May 1, 2002</H2>
<UL>
<LI>
Modified parser to allow unquoted decimal numbers to serve as attribute values.
Scientific notation numbers, numbers with a leading plus sign and
negative numbers where a digit does not follow the minus sign still
require quoting, as does a list of numbers.
</UL>

<H2>March 27, 2002</H2>
<UL>
<LI>
GrappaPanel now implements the java.awt.print.Printable interface.
<LI>
Added a 'Print' function to the pop-up menu provided by the GrappaAdapter class.
</UL>

<H2>March 22, 2002</H2>
<UL>
<LI>
Fixed bug involving resetting of canonical element name when element name is changed (thanks to Bill Fowler, Mount Allison University, Canada).
<LI>
Fixed a bug in the graph enumeration methods (thanks to Jean-Daniel Fekete, University of Maryland, USA).
</UL>


<H2>October 1, 2001</H2>
<UL>
<LI>
Added a new variation of <i>Edge</i> constructor.
<LI>
<i>Edge</i> names now remain unchanged when
<tt>GrappaSupport.filterGraph(...)</tt>
is used.
Previously, any assigned <i>Edge</i> name was lost and replaced by
an automatically generated name after <tt>filterGraph()</tt> was used.
</UL>

<H2>September 24, 2001</H2>
<UL>
<LI>
Added a public <i>Object</i> to the <i>Element</i> class for
applications writers to use as they will.
It is not used by Grappa.
</UL>

<H2>August 30, 2001</H2>
<UL>
<LI>
Added a
<a href="/~john/Grappa/grappa_faq.html">
frequently asked questions (FAQ) page
</a>.
</UL>

<H2>August 14, 2001</H2>
<UL>
<LI>
Re-fixed and re-implemented tagging so that the tag attribute (TAG_ATTR) behaves like any other attribute.
Also modified and renamed the tag related methods in <i>Element</i> (i.e., <tt>addTag</tt>, <tt>hasTag</tt>, <tt>hasLocalTag</tt>, <tt>hasDefaultTag</tt>, <tt>hasTags</tt>, <tt>hasLocalTags</tt>, <tt>hasDefaultTags</tt>, <tt>removeTag</tt> and <tt>removeTags</tt>) and
in <i>Subgraph</i> (i.e., <tt>addTypeTag</tt>, <tt>hasTypeTag</tt>, <tt>hasTypeTags</tt>, <tt>removeTypeTag</tt> and <tt>removeTypeTags</tt>).
<LI>
As suggested by Ginny Travers (bbn.com),
added a printlist attribute (PRINTLIST_ATTR) that can be used to specify which attributes are to be included when using methods that involve printing the graph such as <tt>printSubgraph</tt>, <tt>printElement</tt> or <tt>filterGraph</tt>.
Use of the PRINTLIST_ATTR can be activated either at the <i>Element</i> level setting <b>usePrintList</b> instance variable or at the global level by means of the <b>usePrintList</b> class variable in the <i>Grappa</i> class.
<LI>
Also suggested by Ginny Travers, a <b>printVisibleOnly</b> class variable was added to the <i>Grappa</i> to suppress printing of invisible elements.
<LI>
Following another suggestion by Ginny Travers, some <i>StringBuffer</i> variables in <b>Lexer.java</b> are now reused to be more efficient.
</UL>

<H2>August 3, 2001</H2>
<UL>
<LI>
Fixed the element tagging mechanism so that setting the default tag attribute supplies default tags for all elements affected by that default attribute.
<LI>
Added breadth-first and depth-first searching as method <tt>bdfs(int steps)</tt> in the <i>Element</i> class.
The return value is a vector of vectors.
The vector in the zeroth element of the return vector is always of length 1 and contains the element at which the search was initiated, the vector at position <i>i</i>, if present, contains the elements reachable in <i>i</i> steps from the initial element.
When the <tt>steps</tt> argument is negative, the search is exhaustive.
Reading the return vector in the forward (increasing) direction provides breadth-first results, while reading in the reverse direction provides depth-first results.
</UL>

<H2>July 31, 2001</H2>
<UL>
<LI>
Empty subgraphs are now supplied with a default bounding box having
zero width and zero height and a position of (0,0).
</UL>

<H2>June 12, 2001</H2>
<UL>
<LI>
Corrected the drawing of subgraphs so that the bounding box outline is only
drawn when the subgraph is a cluster subgraph or when the <i>Grappa</i>
class variable <i>outlineSubgraphs</i> is set to true.
</UL>

<H2>May 16, 2001</H2>
<UL>
<LI>
Made the <i>GrappaPanel</i> class into a <i>ComponentListener</i> so that when
it is resized a <i>revalidate()</i> call can be made to make sure the
scrollbars, etc. of any parent container are properly adjusted.
</UL>

<H2>May 4, 2001</H2>
<UL>
<LI>
Added a public, static boolean called <b>waitForImages</b> to the class <i>Grappa</i> that causes Grappa to wait for the IMAGE_ATTR specified image to be loaded before before the element is drawn. By default, Grappa will wait.
</UL>

<H2>May 3, 2001</H2>
<UL>
<LI>
Added <i>image</i> attribute (IMAGE_ATTR) that allows an image to be used as the background of an element.
The attribute should specify a URL or local file path that locates a GIF, JPEG or PNG image (i.e., an image format understood by Java).
The image is scaled to the bounding box of the element's <i>GrappaShape</i> and then clipped by that shape.
The image is drawn after any filling, but before outlines or text are added.
It works for all elements, though it does not make much sense for edges.
The image begins loading when the <i>GrappaNexus</i> object associated with the element is constructed.
If the image has not fully loaded by the time the graph is drawn, the image will be omitted until a request to repaint the graph is made.
<LI>
When a node SHAPE_ATTR is set to "custom" and the CUSTOM_ATTR has been set to the name of a user-supplied class that extends the <i>GrappaShape</i> class, then that user-supplied class is used to specify the <i>Shape</i> of the node.
The class constructor should look like:
<PRE><TT><FONT SIZE='-1'>
   public UserClass(Element elem, double x, double y, double width, double height) {
      super(POLYGON_SHAPE, x, y, width, height, 0, 0, 0, 0, 0, false, false, null);
      // code to save arguments as global variables and
      // to set the GrappaShape path variable at a minimum
   }

</FONT></TT></PRE>
Note that the <i>path</i> built in the constructor is used to determine the bounding box and clipping region of the non-text portion of the node.
Further customization can be accomplished if the class also implements the <i>CustomRenderer</i> interface (see below).
<LI>
Added an interface definition called <i>CustomRenderer</i> that can be used by a user-defined shape class to specify fill, draw and drawImage behavior.
Comments in the <i>CustomRenderer</i> documentation indicate what
default method definitions would look like. Note that the drawImage
method would never be called if IMAGE_ATTR information is never supplied.
<LI>
Started filling edges so that the arrow heads look nicer.
<LI>
Added <i>setlinewidth</i> as a synonym for <i>linewidth</i> when used
in the STYLE_ATTR so that <i>dot</i> can use it when generating PostScript
output.
<LI>
Started using integers instead of floats when calling <i>drawString</i> in
<i>GrappaPanel</i> so that text does not get messed up when scrolling
(I suspect a Java bug in the rounding rules <i>drawString</i> uses).
</UL>

<H2>April 19, 2001</H2>
<UL>
<LI>
Fixed a bug which was probably introduced with the February 15th changes.
The bug occurred while attempting to interactively create an edge between
two nodes with the result that a node was created instead of the desired edge.
The bug was in the <i>GrappaAdapter.java</i> code.
</UL>

<H2>March 5, 2001</H2>
<UL>
<LI>
Added <i>invis</i> as a recognized style</i> attribute element. When present,
the associated element is not drawn and is not interactively selectable.
The effect is the same as setting the <i>visible</i> field in an Element to
false.
To retain backward compatibility while striving to be true to
the <i>dot</i> file format, the redundancy is necessary.
Thus, for an element to be visible <b>both</b> the <i>visible</i> field must
be <tt>true</tt> and <i>invis</i> must not be part of the <i>style</i>
attribute.
Naturally that is the default situation, so by working consistently with
either one method or the other will keep unexpected results from occurring.
</UL>

<H2>February 15, 2001</H2>
<UL>
<LI>
For RECORD_SHAPE and MRECORD_SHAPE shape, the RECTS_ATTR is now
computed based on the LABEL_ATTR value.
Previous releases of Grappa 1.2 relied on "dot" or some other layout engine to
provide the RECTS_ATTR information.
Consequently, changes to the LABEL_ATTR will be reflected in the graph once a
repaint is done.
Note that the width and height of the node are unaffected by this process.
<LI>
Some improvements were made to the edge shapes to improve their selectability.
In particular, the path (i.e., lineTo, curveTo) had only been specified in
one direction and Java automatically closed the path back to the starting
point with a straight line when asked to determine if a point was contained
in the path. Now, the path is specified forward and backwards so the shape is
correct - though it is still hard to select some edges in the parts where
they are very straight - I am open to suggestions here, but it seems like
Java's <i>contains</i> method for shapes returns false when the shape is
one pixel wide and I don't want to force the edges to be wider. I'd like to
think that it is just that I don't know how to use Java well enough and
I am hoping someone out there knows the trick to getting this right.
<LI>
Tightened up multi-line labels so that they correspond more closely to the
way "dot" calculates things rather than relying on the Java
<i>FontMetrics</i> and <i>LineMetrics</i> even though they are more
correct, technically.
</UL>

<H2>February 8, 2001</H2>
<UL>
<LI>
Started keeping a change history.
<LI>
Added <i>GrappaSupport.centerPanel(Point2D cpt, GrappaPanel gpanel)</i>,
which is intended to work with a GrappaPanel whose parent is a JViewport
(e.g, a GrappaPanel inside a JScrollPane) and will postion the graph in
the viewport so that it is centered on the supplied point.
Note that the center point of the bounding box of a graph element, <i>elem</i>, is available as:<pre><tt><font size='-1'>   new Point2D.Double(
      elem.getGrappaNexus().getBounds2D().getCenterX(),
      elem.getGrappaNexus().getBounds2D().getCenterY()
   )
</font></tt></pre>
<LI>
Adjusted the block increment for GrappaPanels whose parent is a JViewport so that clicking on the scroll bar (outside of the arrows or "bubble") causes the
graph to scroll 90% of the visible area in the direction of the scroll bar.
<LI>
Fixed interactive zoom behavior so that it is either centered on
the swept zoom box or remains centered on the current view, depending
on which zoom method is used.
<LI>
Provided
<i>Grappa.nodeLabelsScaleCutoff</i>,
<i>Grappa.edgeLabelsScaleCutoff</i> and
<i>Grappa.subgLabelsScaleCutoff</i>, which indicate the value of the
scale factor below which text labels are suppressed when the graph is drawn.
<LI>
Padded the clipping rectangle in the GrappaPanel by 1 pixel to account for
Java's conservative view of when two rectangles intersect.
<LI>
Fixed several bugs with subgraph bounding box behavior and the BBOX_ATTR ("bbox").
<LI>
The DIR_ATTR ("dir") will now affect the appearance of edges after the edge is created (at edge creation, the information contained in the POS_ATTR ("pos") takes precedence).
<LI>
Changed <i>GrappaListener.grappaClicked()</i> (and the corresponding
method in GrappaAdapter) so that multiple mouse click information is
available. Users that wrote their own grappaClicked()
method will have to add a new <tt>int</tt> argument
to the calling list that provides the click count, which can just be ignored
if it is not needed.
Refer to the documentation for grappaClicked().
</UL>

<!-- /user content -->

</body>
</html>
